---
sidebar_position: 2
sidebar_label: 'Импорт подписчиков'
description: 'Как импортировать пользователей мобильного приложения'
---

import authextId from '/img/subscribers/import-and-export/how-to-prepare-file-for-import/authext-id.png';

# Как импортировать Mobile Push подписчиков

Сервис пуш-уведомлений должен знать адрес устройства пользователя мобильного приложения, прежде чем отправлять уведомления на это устройство. Этот адрес принимает форму токена получателя уведомлений — он уникален как для устройства, так и для приложения. Получить токен пользователя можно только из приложения.

В Sendsay контакты пользователей мобильного приложения хранятся под видом идентификатора `Mobile Push` в формате:

```
token@platform.os.authext_id
```

где:

- `token` — токен пользователя приложения (содержит от 64 символов, иногда его называют `device id` или `hwid`),
- `platform` — через какой сервис пуш-уведомлений будут отправляться уведомления — `apns`, `fcm` или `hms`,
- `os` — операционная система устройства — `ios`, `android` или `huawei`,
- `authext_id` — идентификатор внешней аутентификации, который можно взять из адресной строки на странице приложения:

<p align="center">
  <img width="70%" src={authextId} alt="Authext id" />
</p>

Например:

```
0000F75178A7E26AE732B154ED7720DF510ABE578CFD2605B37088431E1BE2E0@fcm.ios.150
```

Чтобы привести контакты Mobile Push к нужному формату, необходимо объединить данные — подробнее об этом читайте в статье [Как подготовить файл для импорта](https://docs.sendsay.ru/subscribers/import-and-export/how-to-prepare-file-for-import#файл-для-импорта-пользователей-мобильного-приложения).

Импортировать контакты пользователей приложения в базу можно двумя способами:

- загрузить вручную,
- настроить автоматический импорт через вебхук.

## Как загрузить пользователей приложения вручную

Вы можете загрузить токены пользователей приложения в базу контактов или сразу добавить их в список по типу контакта `Mobile Push` двумя способами:

- указать ссылку на [файл с данными](https://docs.sendsay.ru/subscribers/import-and-export/how-to-prepare-file-for-import#файл-для-импорта-mobile-push-подписчиков),
- указать данные вручную.

Для этого:

1. Перейдите в раздел **[Подписчики → Просмотр подписчиков](https://app.sendsay.ru/subscribers/contacts)** и нажмите «Добавить подписчиков»:

   ![How to add subsribers](/img/other-channels/mobile-push/import-mobile-push-subscribers/how-to-add-subsribers.png)

   Либо создайте [список](https://docs.sendsay.ru/subscribers/lists-and-segments/what-is-list) в разделе **[Подписчики → Списки](https://app.sendsay.ru/subscribers/lists)** с типом **Mobile Push** и нажмите «Добавить подписчиков»:

   ![Subscriber list](/img/other-channels/mobile-push/import-mobile-push-subscribers/subscriber-list.gif)

2. Укажите ссылку на [файл](https://docs.sendsay.ru/subscribers/import-and-export/how-to-prepare-file-for-import#файл-для-импорта-mobile-push-подписчиков), либо вручную добавьте контакты и другие данные через запятую.

   Каждая строка должна содержать данные одного пользователя приложения, порядок данных в строках должен быть одинаковым. В случае если у пользователя отсутствуют какие-либо данные, необходимо добавить два разделителя подряд (пробелы необязательны). Например:

   ```
   <token1>@<service>.<os>.<authext_id>,Анатолий,Москва
   <token2>@<service>.<os>.<authext_id>,Светлана,Калуга
   <token3>@<service>.<os>.<authext_id>,,Санкт-Петербург
   ```

   ![Example](/img/other-channels/mobile-push/import-mobile-push-subscribers/mobile-push-contacts.png)

   Затем нажмите «Продолжить».

3. Сопоставьте данные — для этого в каждом столбце с данными выберите нужное поле:

   ![How to match data](/img/other-channels/mobile-push/import-mobile-push-subscribers/how-to-match-data.gif)

   При необходимости укажите или создайте список, куда добавить пользователей приложения. Затем нажмите «Импортировать».

   Результаты импорта отслеживайте в **[Журнале заданий](https://app.sendsay.ru/queue)**.

## Как настроить автоматический импорт пользователей приложения

:::tip Важно
Для настройки автоматического импорта необходимы навыки работы с вебхуками. Обратитесь к разработчику, если не обладаете такими навыками.
:::

Sendsay принимает данные о пользователях мобильного приложения через POST-запрос по индивидуальной ссылке с указанием информации о пользователе.
Ссылка формируется при подключении приложения в формате:

```
https://mobi.sendsay.ru/mobi/api/v100/json/callback/<аккаунт>/<секретный ключ>_<authext_id>
```

Эта ссылка доступна во вкладке **Настройка приложения и импорта** на странице приложения:

![Webhook](/img/other-channels/mobile-push/import-mobile-push-subscribers/webhook.png)

:::tip Важно
Чтобы не обновлять подключение приложения при изменении `webhook.url`, рекомендуем передавать данные не напрямую из приложения, а через прокси-сервер.
:::

### Параметры POST-запроса

```
method: POST
URL: webhook.url
{
  "action": "set",
  "token": "token",
  "platform": "сервис приёма пушей",
  "os": "ОС",
  "os_version": "версия ОС",
  "list": "id группы-списка",
  "dk": {

----передача данных подписчика в анкету или ключ данных----
    "base.firstName": "Иван",
    "base.lastName": "Иванов",
    "base.gender": 1,
    "base.birthDate": "1973-12-31",

----привязка к существующим подписчикам---
    "member.email": ["test@kirtest.ru", "+79110123456"],
    "member.umid":  ["123", "abc"],
},
}
```

где:

- `webhook.url` — уникальная ссылка, которую можно найти на странице приложения во вкладке **Настройка приложения и импорта**,
- `token` — токен пользователя приложения, не короче 64 символов,
- `сервис приёма пушей` — сервис пуш-уведомлений — `fcm`, `apns` или `hms`,
- `ОС` — операционная система — `ios`, `android` или `huawei`, обязательное значение,
- `версия ОС` — операционная система `ios`, `android` или `huawei`, необязательное значение,
- `id группы-списка` — ID списка, в который импортируются подписчики, необязательное значение.

Чтобы передать в Sendsay дополнительную информацию о пользователе и использовать её для сегментации и персонализации уведомлений, укажите значения для `base.firstName`, `base.lastName` и любых других ключей данных в Sendsay.

При указании в `member.email` или `member.umid` идентификатора существующего подписчика, данные объединятся в одну карточку (необязательное значение).

**Читайте также**:<br/>
[Как отправить Mobile Push уведомление](https://docs.sendsay.ru/other-channels/mobile-push/how-to-create-mobile-push-campaign)
