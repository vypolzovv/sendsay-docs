---
sidebar_position: 2
sidebar_label: 'Файл для импорта'
description: Как подготовить файл для загрузки контактов и других данных подписчиков
---

import fieldCode from "/img/subscribers/import-and-export/how-to-prepare-file-for-import/field-code.png";
import fileForAutoimport from "/img/subscribers/import-and-export/how-to-prepare-file-for-import/file-for-autoimport.png";
import fileForManualImport from "/img/subscribers/import-and-export/how-to-prepare-file-for-import/file-for-manual-import.png";
import listType from "/img/subscribers/import-and-export/how-to-prepare-file-for-import/list-type.png";
import Details from '@theme/Details';
import SupportLink from '@site/src/components/SupportLink';
import authextId from '/img/subscribers/import-and-export/how-to-prepare-file-for-import/authext-id.png';

# Как подготовить файл для загрузки контактов

Файл для загрузки контактов и других данных может понадобиться для [импорта подписчиков](https://docs.sendsay.ru/subscribers/import-and-export/how-to-import-subscribers), а также, например, для отправки экспресс-выпусков. Данные в файле должны соответствовать установленному формату.

### 1. Формат файла

Система загружает данные подписчиков из одного файла формата CSV, TXT, XLSX или ZIP. Если контакты и данные ваших подписчиков находятся в разных файлах, их необходимо объединить.

При работе с файлами формата XLSX стоит учитывать, что такой файл поддерживает 1&nbsp;048&nbsp;576 строк на лист.

### 2. Расположение данных в файле

На одной строке записываются данные одного подписчика, порядок данных в строках должен быть одинаковым.
В первой строке для каждого столбца необходимо указать коды полей, куда система запишет данные. Например, вот так может выглядеть файл:

<p align="center">
    <img src={fileForAutoimport} alt="File for autoimport" />
</p>

:::tip Важно
При экспресс-выпуске система не сможет определить адреса и другие данные подписчиков без указания кодов полей. Если их не указать в первой строке файла, выпуск не отправится.
:::

Коды полей хранятся в [анкетах](https://docs.sendsay.ru/subscribers/subscriber-data/data-groups). Префикс «anketa» копировать не нужно: например, для столбца с именами нужно скопировать `base.firstName`.

<p align="center">
    <img src={fieldCode} alt="Field code" />
</p>

При обычном [импорте подписчиков](https://docs.sendsay.ru/subscribers/import-and-export/how-to-import-subscribers) через интерфейс в первой строке файла можно просто указать наименования столбцов, так как поля со столбцами сопоставляются вручную.

<p align="center">
    <img src={fileForManualImport} alt="File for manual import" />
</p>

### 3. Разделитель данных

В Excel данные записываются в ячейки таблицы, а в остальных случаях их нужно разделять запятой, точкой с запятой или табуляцией (разделитель должен быть одинаковым в каждой строке).

```csv
pochta1@gmail.com, Иван, Иванов, Москва, 1970-01-21
```

Если у подписчика отсутствуют какие-то данные, вместо них нужно ставить два разделителя подряд (пробелы необязательны).

```csv
pochta2@gmail.com, , Фёдоров, , 1980-02-14
```

### 4. Основной контакт

В файле должен быть один контакт, который заполнен у всех подписчиков (он называется основной контакт). Это может быть:

- электронный адрес,
- телефон,
- идентификатор CSID,
- ID пользователя в Телеграме (это комбинация цифр — отправлять рассылки через бота по нику или номеру телефона нельзя),
- [идентификатор пользователя приложения](#файл-для-импорта-mobile-push-подписчиков) для отправки Mobile Push уведомлений.

По основному контакту происходит склеивание данных, если вы загружаете данные, которые уже есть в базе. Подписчики без основного контакта не загружаются. Если вы импортируете контакты в список, тип основного контакта должен совпадать с типом списка:

<p align="center">
    <img src={listType} alt="List type" />
</p>

Если вы импортируете контакты без списка, основной контакт нужно выбрать самостоятельно в настройках импорта:

![How to choose list during import](/img/subscribers/import-and-export\how-to-prepare-file-for-import/how-to-choose-list-during-import.gif) <br/>

:::tip Важно
При [автоматическом импорте](https://docs.sendsay.ru/automations/autoimport/how-to-set-autoimport) у подписчиков может быть только основной контакт. Чтобы загружать дополнительные контакты, <SupportLink>напишите в чат поддержки</SupportLink>.
:::

### 5. Формат записи дат и телефонных номеров

Даты указываются в формате ГГГГ-ММ-ДД. Например, для даты «1 июля 1993 года» запись будет такой:

```
1993-07-01
```

Телефонные номера можно указывать в любом виде — со скобками, пробелами или цифры подряд. В российских номерах код страны указывать необязательно, а если он есть, то допустим в любом виде — 7, +7 или 8. Номера других стран нужно писать в полном виде.

### 6. Какие данные не загружаются

Чтобы исключить из импорта конкретного подписчика, добавьте символ # в начало строки.

```
#pochta5@gmail.com, Пётр, Петров, Новгород, 1989-01-01
```

В настройках ручного импорта можно указать, какие столбцы не нужно загружать. Также при импорте не загружаются следующие данные:

- контакты с опечатками,
- повторяющиеся контакты (из повторов будет загружен только последний вариант),
- данные, которые не соответствуют формату поля.

:::tip Важно
Страны надо указывать только на русском языке, иначе они не будут загружены
:::

## Файл для импорта Mobile Push подписчиков

Контакты пользователей мобильного приложения хранятся в Sendsay под видом контакта `Mobile Push` в формате:

```
token@platform.os.authext_id
```

где:

- `token` — токен пользователя приложения, содержит от 64 символов,
- `platform` указывает, через какой сервис пуш-уведомлений будут отправляться уведомления — `apns`, `fcm` или `hms`,
- `os` — операционная система приложения — `ios`, `android` или `huawei`,
- `authext_id` — идентификатор внешней аутентификации, который можно взять из адресной строки на странице приложения:

<p align="center">
  <img width="70%" src={authextId} alt="Authext id" />
</p>

Например:

```
0000F75178A7E26AE732B154ED7720DF510ABE578CFD2605B37088431E1BE2E0@fcm.ios.150
```

Чтобы привести контакты к нужному формату, необходимо объединить данные.

<Details summary='Как объединить данные для идентификаторов'>

«Склеить» данные для каждого контакта можно в таблицах с помощью формулы, — например, в Exel или в [Google Sheets](https://workspace.google.com/intl/ru/products/sheets/). Как это сделать:

1. Укажите токены пользователей мобильного приложения `token` в первом столбце таблицы — по одному токену на каждую ячейку.
2. В верхней ячейке второго столбца укажите сервис пуш-уведомлений — `apns`, `fcm` или `hms`.
3. В третьем столбце укажите операционную систему — `ios`, `android` или `huawei`.
4. В четвёртом столбце укажите идентификатор внешней авторизации.
5. Скопируйте ячейки 2–4 вниз на весь столбец, протянув их за правый нижний угол первой ячейки:

   ![How to prepare mobile push contacts](/img/subscribers/import-and-export/how-to-prepare-file-for-import/how-to-prepare-mobile-push-contacts.gif)

6. В верхней ячейке следующего столбца введите знак равенства `=` и укажите формулу для объединения ячеек:

   ```
   =<первая ячейка>&"@"&<вторая ячейка>&"."&<третья ячейка>&"."&<четвёртая ячейка>
   ```

   где `&` — знак для объединения ячеек, а символы в кавычках (`”@”` или `”.”`) объединяют символы внутри ячеек.

   В нашем примере формула будет такой:

   ```
   =A1&"@"&B1&"."&C1&"."&D1
   ```

   Затем нажмите клавишу ввода — формула автоматически преобразуется в нужное значение. Скопируйте ячейку с формулой вниз на весь столбец.

   ![Mobile push contacts](/img/subscribers/import-and-export/how-to-prepare-file-for-import/how-to-prepare-mobile-push-contacts1.gif)

   Так вы получите столбец с идентификаторами получателей мобильных пуш-уведомлений в нужном формате. Перенесите их в файл формата CSV, TXT, XLSX или ZIP для импорта Mobile Push подписчиков в Sendsay.

</Details>

Укажите идентификаторы Mobile Push подписчиков в первом столбце файла, в следующих столбцах — другие данные пользователей. Каждая строка должна содержать данные одного пользователя приложения, порядок данных в строках должен быть одинаковым. В остальном требования к оформлению файла не отличаются от обычного импорта подписчиков.

**Читайте также:**<br/>
[Как импортировать Mobile Push подписчиков](https://docs.sendsay.ru/other-channels/mobile-push/import-mobile-push-subscribers)<br/>
[Как настроить параметры импорта](https://docs.sendsay.ru/subscribers/import-and-export/how-to-import-subscribers#2-настройте-параметры-импорта)
