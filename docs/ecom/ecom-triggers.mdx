---
sidebar_position: 4
sidebar_label: 'Триггерные сценарии'
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import changeDesign from '/img/ecom/ecom-triggers/change-design.png';
import preview from '/img/ecom/ecom-triggers/preview.png';
import preview1 from '/img/ecom/ecom-triggers/preview1.png';
import delayTime from '/img/ecom/ecom-triggers/delay-time.png';

# Руководство по триггерным сценариям для онлайн-продаж

**Триггерный сценарий для онлайн-продаж** — это автоматическая отправка писем, с&nbsp;помощью которых можно вернуть подписчика на&nbsp;сайт. В&nbsp;таких сценариях рассылки отправляются при наступлении соответствующего события на&nbsp;сайте: когда подписчик посмотрел товар или категорию, добавил товар в&nbsp;корзину и&nbsp;так далее.

С&nbsp;триггерными сценариями для онлайн-продаж можно максимально персонализировать коммуникации, используя данные о&nbsp;поведении подписчиков на&nbsp;сайте. Чтобы настроить такой сценарий, сперва нужно подключить модуль **Продажи** и&nbsp;настроить передачу данных сайта в&nbsp;Sendsay.

[Модуль Продажи: что это и как подключить](https://docs.sendsay.ru/ecom/how-to-connect-ecom)

С&nbsp;версиями модуля «Продажи Старт» и «Продажи» можно запустить несколько таких сценариев:

- Брошенная корзина&nbsp;&mdash; пользователь положил товар в&nbsp;корзину и&nbsp;не&nbsp;оформил заказ. Через полчаса ему приходит письмо с&nbsp;товарами корзины;
- Брошенный просмотр&nbsp;&mdash; пользователь просмотрел карточки товаров и&nbsp;не&nbsp;оформил заказ. Через полчаса ему приходит письмо с&nbsp;просмотренными товарами;
- Брошенная категория&nbsp;&mdash; пользователь посмотрел категорию товаров и&nbsp;не&nbsp;перешёл в&nbsp;карточку ни&nbsp;одного из&nbsp;товаров. Через полчаса ему приходит письмо с&nbsp;товарами из&nbsp;категории.

:::tip Важно
По&nbsp;умолчанию триггерные события наступают через 30&nbsp;минут после действия пользователя на&nbsp;сайте. Время отправки писем можно изменить в&nbsp;настройках сценария.
:::

## Как подключить сценарий

1. Перейдите в&nbsp;раздел **Продажи** в&nbsp;боковом меню и&nbsp;выберите вкладку **Сценарии** на&nbsp;странице сайта.
2. Выберите нужный сценарий из&nbsp;доступных и&nbsp;кликните по&nbsp;кнопке &laquo;Подключить&raquo;:
   ![How to connect workflow](/img/ecom/ecom-triggers/how-to-connect-workflow.png)
3. После подключения сценария перейдите в его настройки, нажав кнопку «Просмотр».

В&nbsp;списке сценариев отображаются статусы&nbsp;&mdash; активны они или нет. Также выводятся данные:

![List of workflows](/img/ecom/ecom-triggers/list-of-workflows.png)

- **Всего участий**&nbsp;&mdash; сколько раз подписчики попадали в&nbsp;сценарий, в&nbsp;том числе повторно,
- **Завершений**&nbsp;&mdash; сколько подписчиков завершили сценарий, в&nbsp;том числе повторно.

Эти показатели учитывают каждого участника, даже если он&nbsp;только попал в&nbsp;сценарий. Или если сценарий был завершён принудительно&nbsp;&mdash; например, когда участник совершил событие, завершающее сценарий.

[События, завершающие сценарий](https://docs.sendsay.ru/ecom/how-to-connect-ecom#события-завершающие-сценарий)

## Как настроить сценарий

Перед настройкой сценария рекомендуем подключить каталог товаров&nbsp;&mdash; он&nbsp;понадобится для сценария Брошенная категория и&nbsp;товарных рекомендаций в&nbsp;письмах.

[Как подключить каталог товаров](https://docs.sendsay.ru/ecom/product-catalog)

Каждый сценарий настраивается по&nbsp;одному принципу: нужно добавить письмо в&nbsp;сценарий и&nbsp;установить время задержки отправки. Исключением является сценарий Брошенная корзина [на&nbsp;платной версии модуля &laquo;Продажи&raquo;](https://docs.sendsay.ru/ecom/how-to-connect-ecom#возможности-версий)&nbsp;&mdash; в&nbsp;такой сценарий можно добавить до&nbsp;5&nbsp;писем.

Чтобы настроить сценарий:

### 1. Добавьте письмо

Перейдите в&nbsp;раздел **Продажи &rarr; Сценарии**, выберите из&nbsp;списка нужный сценарий и&nbsp;нажмите &laquo;Просмотр&raquo;. Затем на&nbsp;странице сценария выберите вкладку **Настройка** и&nbsp;на&nbsp;шаге Письмо 1&nbsp;нажмите &laquo;Редактировать&raquo;:

![Workflow settings](/img/ecom/ecom-triggers/workflow-settings.png)

Во&nbsp;всплывающем окне откроется редактирование письма. На&nbsp;шаге **Письмо** нажмите &laquo;Редактировать&raquo; в&nbsp;превью шаблона, затем отредактируйте его контент и&nbsp;оформление.

<Tabs>
<TabItem value="key1" label="Редактирование шаблона" default>

Дизайн блока со&nbsp;специальным кодом для вывода товаров уже есть в&nbsp;шаблоне письма&nbsp;&mdash; его можно не&nbsp;редактировать:

![Template](/img/ecom/ecom-triggers/template.png)

[Как создать письмо в блочном редакторе](https://docs.sendsay.ru/videolessons/email-campaigns/drag-and-drop-editor)

Если всё&nbsp;же нужно отредактировать, шаблоны таких блоков доступны в&nbsp;папке **Контент &rarr; Название вашего сайта**.

</TabItem>
<TabItem value="key2" label="Изменение дизайна">

Вы&nbsp;можете сменить дизайн письма, нажав на&nbsp;три точки в&nbsp;правом нижнем углу в&nbsp;блочном редакторе:

<p align="center">
  <img width="50%" src={changeDesign} alt="Change design" />
</p>

Если вы&nbsp;сменили дизайн письма, в&nbsp;макет нужно добавить команду подстановки&nbsp;&mdash; чтобы сценарий заработал. Для этого перетащите в&nbsp;письмо HTML-блок и&nbsp;задайте отступ 0&nbsp;справа и&nbsp;слева, затем пропишите в&nbsp;блоке код шаблона:

- для сценария Брошенный просмотр:<br/>
  `[% draft("id","mysite.ru_product_view") %]`

- для сценария Брошенная корзина:<br/>
  `[% draft("id","mysite.ru_basket") %]`

- для сценария Брошенная категория:<br/>
  `[% draft("id","mysite.ru_category_view") %]`

Где `mysite.ru` — название подключенного сайта. Например, так будет выглядеть код для сайта Sendsay:

```
[% draft("id","sendsay.ru_category_view") %]
```

![How to insert the code](/img/ecom/ecom-triggers/change-design1.gif)

[Как создать письмо в блочном редакторе](https://docs.sendsay.ru/videolessons/email-campaigns/drag-and-drop-editor)

</TabItem>
<TabItem value="key3" label="Свой шаблон в HTML">
Если вы&nbsp;используете свой шаблон в&nbsp;HTML, в&nbsp;нём нужно сверстать блок с&nbsp;выводом товаров. Как это сделать&nbsp;&mdash; читайте в&nbsp;статье по&nbsp;ссылке ниже.<br/><br/>

[Шаблонизатор PROScript](https://docs.sendsay.ru/ecom/ecom-proscript)

</TabItem>
</Tabs>

Когда контент письма готов, сохраните его и&nbsp;вернитесь к&nbsp;редактированию письма. На&nbsp;шаге **Письмо** задайте рассылке нужные настройки: **Имя отправителя**, **Email отправителя** и&nbsp;**Тему письма**.

### 2. Посмотрите письмо, подставив данные подписчика

Этот пункт необязательный, но&nbsp;он&nbsp;поможет понять, что в&nbsp;письме всё работает так, как вы&nbsp;ожидаете. Для этого:

1. Перейдите на&nbsp;страницу нужного сценария и&nbsp;откройте вкладку **Настройка**.
2. Выберите письмо и&nbsp;нажмите &laquo;Просмотреть&raquo;:

   ![How to view an email with subscriber data](/img/ecom/ecom-triggers/how-to-view-email.png)

3. В&nbsp;правом верхнем углу кликните по&nbsp;ссылке &laquo;Без персонализации&raquo; и&nbsp;выберите пункт **Выбрать подписчика**.
4. В&nbsp;новом окне введите email-адрес подписчика и&nbsp;нажмите &laquo;Выбрать подписчика&raquo:

   ![How to view an email with subscriber data](/img/ecom/ecom-triggers/how-to-view-email1.gif)

   Адрес подписчика можно взять из&nbsp;раздела **Продажи &rarr; Просмотр событий**. Для этого отфильтруйте таблицу по&nbsp;нужному событию.

Посмотреть письмо с&nbsp;данными подписчика можно также в&nbsp;редакторе письма:

1. Выберите нужный шаблон письма в&nbsp;разделе **Контент** и&nbsp;перейдите к&nbsp;его редактированию.
2. В&nbsp;самом верху экрана кликните по&nbsp;иконке предпросмотра:
   <p align="center">
     <img width="50%" src={preview} alt="Preview" />
   </p>
3. Справа появится меню предпросмотра&nbsp;&mdash; выберите пункт **Посмотреть письмо с&nbsp;данными конкретного подписчика**, введите email и&nbsp;нажмите кнопку &laquo;Применить&raquo;.
   <p align="center">
     <img width="50%" src={preview1} alt="Preview" />
   </p>

После этого вернитесь на&nbsp;страницу сценария.

### 3. Настройте время задержки отправки

На&nbsp;шаге **Время задержки** нажмите &laquo;Изменить&raquo; и&nbsp;установите нужное время:

<p align="center">
  <img width="50%" src={delayTime} alt="Delay time" />
</p>

:::tip Важно
Отправка первого письма в&nbsp;сценарии запускается автоматически через 30&nbsp;минут после наступления события&nbsp;&mdash; это время можно увеличить вручную. Если вы&nbsp;хотите уменьшить или увеличить время задержки для всех сценариев вашего аккаунта, обратитесь в&nbsp;техподдержку.
:::

### 4. Добавьте другие письма (опционально)

Вы&nbsp;можете добавить до&nbsp;5&nbsp;писем в&nbsp;сценарий Брошенная корзина, если используете платную версию модуля &laquo;Продажи&raquo;. Чтобы создать цепочку из&nbsp;нескольких писем, нажмите &laquo;Добавить письмо&raquo; при настройке сценария:

![How to add a second email](/img/ecom/ecom-triggers/how-to-add-second-email.png)

При добавлении новых писем в&nbsp;цепочку повторите пункты 1&ndash;3.

## Как удалить письмо из&nbsp;сценария

Первое письмо сценария нельзя удалить. Вы&nbsp;можете его отредактировать или заменить шаблон. Если необходимо удалить другие письма из&nbsp;сценария:

1. Перейдите во&nbsp;вкладку **Настройка** на&nbsp;странице сценария и&nbsp;выберите нужное письмо.
2. Откройте раскрывающийся список у кнопки &laquo;Редактировать&raquo; и&nbsp;выберите пункт **Удалить шаг**:

   ![How to delete email](/img/ecom/ecom-triggers/how-to-delete-email.png)

## Как активировать сценарий

Когда все письма триггерной цепочки добавлены в&nbsp;сценарий, а&nbsp;время задержки установлено, нажмите зелёную кнопку &laquo;Активировать&raquo; в&nbsp;правом верхнем углу на&nbsp;странице сценария, чтобы запустить его в&nbsp;работу:

![Activate the workflow](/img/ecom/ecom-triggers/activate-the-workflow.png)

После активации кнопка &laquo;На&nbsp;паузу&raquo; приостановит выпуск рассылок по&nbsp;сценарию.

![Pause the workflow](/img/ecom/ecom-triggers/pause-the-workflow.png)

## Как узнать статистику по&nbsp;сценарию

После запуска триггерного сценария система собирает статистику по&nbsp;основным показателям самого сценария. Чтобы посмотреть показатели, перейдите на&nbsp;страницу сценария: во&nbsp;вкладке **Сводка** собрана статистика по&nbsp;сценарию и&nbsp;всем выпускам в&nbsp;одной таблице.

В&nbsp;статистике по&nbsp;сценарию выводятся данные:

![Statistics](/img/ecom/ecom-triggers/statistics.png)

- **Проходят сценарий**&nbsp;&mdash; количество подписчиков, которые попали в&nbsp;сценарий и&nbsp;стоят в&nbsp;очереди на&nbsp;получение хотя&nbsp;бы одного письма из&nbsp;цепочки в&nbsp;текущий момент.
- **Завершений сценария**&nbsp;&mdash; число подписчиков, которые получили все письма сценария, а&nbsp;также тех, кто завершил его досрочно: например, если подписчик сделал заказ или для него вручную завершили сценарий.
- **Сделано заказов**&nbsp;&mdash; количество совершенных заказов подписчиками, перешедшими на&nbsp;сайт из&nbsp;рассылок сценария.
- **Сумма**&nbsp;&mdash; сумма всех покупок, которые оплатили подписчики, перешедшие на&nbsp;сайт из&nbsp;рассылок сценария.

Ниже отображается таблица со&nbsp;статистикой по&nbsp;отправленным выпускам, которые участвовали в&nbsp;этом сценарии&nbsp;&mdash; её&nbsp;можно экспортировать в&nbsp;формате .xlsx или .csv. Здесь также можно отфильтровать таблицу по&nbsp;периоду и&nbsp;конкретному выпуску:

![Filter and export](/img/ecom/ecom-triggers/filter-and-export.png)

## Как посмотреть историю событий для конкретного подписчика

В&nbsp;разделе **Продажи &rarr; Просмотр событий** выводится информация о&nbsp;событиях&nbsp;&mdash; как тот или иной пользователь &laquo;гулял&raquo; по&nbsp;страницам сайта: просматривал категории и&nbsp;товары, добавлял товары в&nbsp;корзину или оформлял заказ:

![Event viewing](/img/ecom/ecom-triggers/event-viewing.png)

Здесь собраны данные о&nbsp;контактах и&nbsp;их&nbsp;действиях на&nbsp;сайте. Кликните на&nbsp;строку таблицы, чтобы открыть карточку подписчика. Во&nbsp;вкладке **События сайта**&nbsp;&mdash; вы&nbsp;увидите все события, которые совершил подписчик на&nbsp;сайте:

![Subscriber events](/img/ecom/ecom-triggers/subscriber-events.png)

При наведении курсора на&nbsp;конкретное событие появляется кнопка &laquo;Детали&raquo;. Нажмите на&nbsp;неё, если хотите получить более подробную информацию о&nbsp;событии: какой товар посмотрел подписчик или что именно он&nbsp;положил в&nbsp;корзину.

![Event details](/img/ecom/ecom-triggers/event-details.gif)

[Как посмотреть историю событий сайта](https://docs.sendsay.ru/ecom/how-to-connect-ecom/#как-посмотреть-историю-событий-сайта)

## Как узнать статус участника в&nbsp;сценарии

На&nbsp;странице триггерного сценария собраны данные о&nbsp;контактах&nbsp;&mdash; тех, кто проходит или уже завершил сценарий. Эти данные могут пригодиться, например, если вам нужно перенести подписчиков с&nbsp;одинаковым статусом в&nbsp;отдельный список.

Чтобы узнать статус подписчика в&nbsp;сценарии, выберите нужный сценарий и&nbsp;нажмите &laquo;Просмотр&raquo;. Затем на&nbsp;странице сценария откройте вкладку **Просмотр подписчиков**. Здесь находится таблица с&nbsp;тремя колонками: адресами контактов, статусом прохождения сценария и&nbsp;датой&nbsp;&mdash; когда тот или иной подписчик совершил последнее действие на&nbsp;сайте:

![Subscriber statuses](/img/ecom/ecom-triggers/subscriber-statuses.png)

Есть несколько статусов прохождения сценария:

- **Проходит сценарий**&nbsp;&mdash; когда подписчик попал в&nbsp;сценарий и&nbsp;стоит в&nbsp;очереди на&nbsp;получение хотя&nbsp;бы одного письма цепочки;
- **На&nbsp;паузе**&nbsp;&mdash; когда работа сценария приостановлена для конкретного подписчика;
- **Исключен принудительно**&nbsp;&mdash; когда наступило событие, завершившее сценарий, либо сценарий для подписчика завершили вручную. Система подскажет точную причину при наведении на&nbsp;иконку `i`.
- **Завершено**&nbsp;&mdash; когда подписчик получил все письма сценария.

По&nbsp;этому&nbsp;же принципу можно настроить фильтр в&nbsp;таблице:

![Filter statuses](/img/ecom/ecom-triggers/filter-statuses.png)

Ещё здесь можно завершить сценарий для конкретного подписчика, добавить его в&nbsp;список или вовсе удалить из&nbsp;базы.

### Как вручную завершить сценарий для конкретного подписчика

Чтобы завершить сценарий для конкретных подписчиков, выберите нужные контакты и&nbsp;отметьте их&nbsp;галочкой слева от&nbsp;адреса. Затем нажмите &laquo;Завершить сценарий&raquo;:

![Forced termination](/img/ecom/ecom-triggers/forced-termination.png)

### Как добавить подписчика в&nbsp;список

Если хотите добавить конкретных подписчиков в&nbsp;список, выберите нужные контакты и&nbsp;отметьте их&nbsp;галочкой слева от&nbsp;адреса. После этого откройте список у кнопки &laquo;Завершить сценарий&raquo; и&nbsp;выберите пункт **Добавить в&nbsp;список**:

![List entry](/img/ecom/ecom-triggers/list-entry.png)

Затем выберите нужный список и&nbsp;нажмите синюю кнопку &laquo;Добавить&raquo;.

[Что такое список контактов](https://docs.sendsay.ru/subscribers/lists-and-segments/what-is-list)

### Как удалить подписчика из&nbsp;базы

Чтобы удалить подписчиков из&nbsp;базы, выберите нужные контакты и&nbsp;отметьте их&nbsp;галочкой слева от&nbsp;адреса. После откройте список у кнопки &laquo;Завершить сценарий&raquo; и&nbsp;выберите пункт **Удалить из&nbsp;базы**:

![How to delete subscribers](/img/ecom/ecom-triggers/delete-subscribers.png)

**Читайте также:**<br/>
[Где следить за статистикой](https://docs.sendsay.ru/statistics/where-to-track-statistics)<br/>
[Всё про статистические отчёты](https://docs.sendsay.ru/statistics/all-about-campaign-reports)
